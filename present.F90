SUBROUTINE CALLER(A, LDFLAG)

USE PARKIND1, ONLY : KLON, KLEV

IMPLICIT NONE 

#include "abor0.intfb.h"
REAL,   INTENT(INOUT) :: A
REAL :: Z(KLON, KLEV)
LOGICAL, INTENT(OUT) :: LDFLAG(KLON)
INTEGER :: JLON

DO JLON=1,KLON
LDFLAG(JLON)=.TRUE.
ENDDO

!LDFLAG=.FALSE.
CALL CALLEE(LDFLAG)

CONTAINS

SUBROUTINE CALLEE(LDOFLAG)

USE PARKIND1, ONLY : KLON, KLEV

IMPLICIT NONE

LOGICAL, INTENT(IN), OPTIONAL :: LDOFLAG(KLON)
INTEGER :: JLON

IF (PRESENT(LDOFLAG)) THEN 
PRINT *, "PRESENT"
ELSE
PRINT *, "NOT PRESENT"
ENDIF 

END SUBROUTINE

END SUBROUTINE 
